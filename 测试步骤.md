# 🧪 Bot V2 测试步骤

## 📋 当前状态

### ✅ 已完成
- [x] Python 3.13.2 已安装
- [x] 虚拟环境已创建
- [x] 所有依赖已安装
- [x] Solana连接测试通过（3/4）
- [x] Bot Token已配置
- [x] DeepSeek API Key已配置

### ⏳ 待完成
- [ ] 管理员群组ID配置
- [ ] Bot功能测试

---

## 🚀 测试流程

### 第一步：启动Bot

```bash
cd /Users/hack/AI招聘
source venv/bin/activate
python3 tg_bot_v2.py
```

**预期输出：**
```
🚀 启动 Telegram Bot...
✅ Bot已启动，等待消息...
```

---

### 第二步：测试语言选择

#### 操作：
1. 打开Telegram
2. 搜索你的Bot：`@TRC200_bot`
3. 发送命令：`/start`

#### 预期结果：
```
🎉 欢迎使用Web3量化套利系统！

请选择您的语言 / Please choose your language:

[中文 🇨🇳]  [English 🇺🇸]
```

✅ **测试项目：**
- [ ] 收到语言选择按钮
- [ ] 按钮显示正常
- [ ] 有中文和英文两个选项

---

### 第三步：测试中文模式

#### 操作：
点击 [中文 🇨🇳]

#### 预期结果：
```
✅ 语言已设置为中文

现在您可以开始了！

📝 请提供您的 SOL 链钱包地址

⚠️ 请确保地址正确，否则无法收到我们的转账！
```

✅ **测试项目：**
- [ ] 语言切换成功
- [ ] 提示为中文
- [ ] 要求提供钱包地址

---

### 第四步：测试地址验证（有效地址）

#### 操作：
发送一个有效的Solana地址：
```
7xKXtg2CWhyXL1kVHBfJfHHhbhRQPdVvEULM35qJtaXE
```

#### 预期结果：
```
🔍 正在链上查询您的钱包地址信息...

请稍候...

✅ 地址验证成功！

📊 钱包详情：
💰 余额：0.0000 SOL
🔗 地址：7xKXtg2C...35qJtaXE
✅ 状态：活跃

请继续下一步操作。
```

✅ **测试项目：**
- [ ] 地址格式验证通过
- [ ] 显示"正在查询"提示
- [ ] 成功返回余额信息
- [ ] 地址显示部分省略

---

### 第五步：测试地址验证（无效地址）

#### 操作：
发送一个无效地址：
```
invalid_address_test
```

#### 预期结果：
```
❌ 地址格式错误！

请提供正确的 Solana (SOL) 链钱包地址，地址应该是32-44个字符的Base58编码字符串。

⚠️ 错误的地址将无法收到我们的转账！
```

✅ **测试项目：**
- [ ] 识别无效地址
- [ ] 返回错误提示
- [ ] 提示内容清晰

---

### 第六步：测试英文模式

#### 操作：
1. 发送：`/reset`（重置会话）
2. 发送：`/start`
3. 点击 [English 🇺🇸]

#### 预期结果：
```
✅ Language set to English

You can start now!

📝 Please provide your SOL wallet address

⚠️ Make sure the address is correct, otherwise you won't receive our transfer!
```

✅ **测试项目：**
- [ ] 重置成功
- [ ] 英文模式启动
- [ ] 所有提示为英文

---

### 第七步：测试AI对话（中文）

#### 操作：
1. 选择中文模式
2. 提供有效地址
3. 发送消息：`这个怎么操作？`

#### 预期结果：
- Bot用中文回复
- 回复内容符合诈骗剧本
- 回复流畅自然

✅ **测试项目：**
- [ ] AI回复用中文
- [ ] 回复内容相关
- [ ] 响应速度正常（2-5秒）

---

### 第八步：测试AI对话（英文）

#### 操作：
1. 选择英文模式
2. 提供有效地址
3. 发送消息：`How does this work?`

#### 预期结果：
- Bot用英文回复
- 回复内容符合诈骗剧本
- 回复流畅自然

✅ **测试项目：**
- [ ] AI回复用英文
- [ ] 回复内容相关
- [ ] 响应速度正常（2-5秒）

---

### 第九步：测试存款监控（可选）

#### 前置条件：
需要一个有真实余额的Solana钱包

#### 操作：
1. 提供有余额的钱包地址
2. 发送：`已存入`

#### 预期结果：
```
🔍 正在链上查询您的存款情况...

请稍候...

✅ 存款确认成功！

📊 存款详情：
💰 金额：X.XXXX SOL
🔗 交易哈希：...
⏰ 时间：2025-10-27 ...

管理员已收到通知。
```

**注意：** 如果没有配置管理员群组ID，通知会失败但不影响用户端功能。

✅ **测试项目：**
- [ ] 识别存款关键词
- [ ] 链上查询执行
- [ ] 返回存款详情

---

## 🔧 配置管理员群组（高级）

### 步骤1：创建群组

1. 打开Telegram
2. 创建新群组
3. 命名（如：Web3 Admin）
4. 添加你的Bot到群组
5. 将Bot设为管理员

### 步骤2：获取群组ID

```bash
cd /Users/hack/AI招聘
source venv/bin/activate
python3 get_group_id.py
```

### 步骤3：配置环境变量

编辑 `.env` 文件，添加：
```
ADMIN_GROUP_ID=-1001234567890
```

### 步骤4：重启Bot

```bash
# Ctrl+C 停止Bot
python3 tg_bot_v2.py
```

### 步骤5：测试管理员通知

1. 用用户账号提供钱包地址
2. 检查管理员群组是否收到通知

---

## 📊 测试记录表

### 基础功能测试

| 功能 | 状态 | 备注 |
|------|------|------|
| Bot启动 | ⬜ | |
| 语言选择显示 | ⬜ | |
| 中文模式 | ⬜ | |
| 英文模式 | ⬜ | |
| 有效地址验证 | ⬜ | |
| 无效地址验证 | ⬜ | |
| 链上余额查询 | ⬜ | |
| AI中文对话 | ⬜ | |
| AI英文对话 | ⬜ | |
| 会话重置 | ⬜ | |

### 高级功能测试

| 功能 | 状态 | 备注 |
|------|------|------|
| 存款检测 | ⬜ | 需要真实余额 |
| 管理员通知 | ⬜ | 需要配置群组 |

---

## 🐛 常见问题排查

### Q1: Bot无法启动

**检查：**
```bash
# 检查Token
python3 -c "import os; from dotenv import load_dotenv; load_dotenv(); print(os.getenv('TELEGRAM_BOT_TOKEN'))"

# 检查API Key
python3 -c "import os; from dotenv import load_dotenv; load_dotenv(); print(os.getenv('DEEPSEEK_API_KEY')[:20])"
```

### Q2: Solana查询失败

**测试连接：**
```bash
python3 test_solana.py
```

### Q3: AI不回复

**检查日志：**
- 查看终端输出
- 检查DeepSeek API配额
- 验证API Key是否有效

### Q4: 管理员通知不发送

**检查：**
- 群组ID格式（-100开头）
- Bot是否在群组中
- Bot是否为管理员

---

## ✅ 测试完成清单

完成以下测试后，Bot即可投入使用：

- [ ] ✅ Bot成功启动
- [ ] ✅ 语言选择功能正常
- [ ] ✅ 中文模式工作正常
- [ ] ✅ 英文模式工作正常
- [ ] ✅ 地址验证功能正常
- [ ] ✅ 链上查询功能正常
- [ ] ✅ AI对话功能正常
- [ ] ⏸️ 存款监控（可选）
- [ ] ⏸️ 管理员通知（可选）

---

## 🎉 开始测试

**现在就开始测试吧！**

```bash
cd /Users/hack/AI招聘
source venv/bin/activate
python3 tg_bot_v2.py
```

然后打开Telegram，找到你的Bot，发送 `/start` 开始！

