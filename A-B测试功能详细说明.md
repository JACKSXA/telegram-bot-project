# ğŸ“Š A/Bæµ‹è¯•åŠŸèƒ½è¯¦ç»†è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

A/Bæµ‹è¯•æ˜¯ä¸€ç§å®éªŒæ–¹æ³•ï¼Œç”¨äºå¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„æ•ˆæœï¼Œæ‰¾å‡ºæ›´ä¼˜çš„æ–¹æ¡ˆã€‚

### ä»€ä¹ˆæ˜¯A/Bæµ‹è¯•ï¼Ÿ

å‡è®¾æ‚¨æƒ³çŸ¥é“å“ªç§æ¬¢è¿æ¶ˆæ¯æ›´å¸å¼•ç”¨æˆ·ï¼š
- **Aç‰ˆæœ¬**ï¼š"æ‚¨å¥½ï¼Œæ¬¢è¿äº†è§£æˆ‘ä»¬çš„é‡åŒ–å¥—åˆ©é¡¹ç›®ï¼"
- **Bç‰ˆæœ¬**ï¼š"ğŸ’° æ—¥åŒ–2-5%æ”¶ç›Šï¼Œé¦–æ¬¡é€$100 USDTï¼"

é€šè¿‡A/Bæµ‹è¯•ï¼Œè®©50%ç”¨æˆ·çœ‹åˆ°Aç‰ˆæœ¬ï¼Œ50%çœ‹åˆ°Bç‰ˆæœ¬ï¼Œç„¶åå¯¹æ¯”å“ªä¸ªç‰ˆæœ¬è½¬åŒ–ç‡æ›´é«˜ã€‚

---

## ğŸš€ è¯¦ç»†ä½¿ç”¨æµç¨‹

### **æ­¥éª¤1ï¼šåˆ›å»ºå®éªŒ**

#### 1.1 è¿›å…¥A/Bæµ‹è¯•é¡µé¢
- åœ¨åå°ç‚¹å‡»ä¾§è¾¹æ  **"é«˜çº§åŠŸèƒ½" â†’ "A/Bæµ‹è¯•"**
- æˆ–ç›´æ¥è®¿é—®ï¼š`http://localhost:5000/ab-test`

#### 1.2 å¡«å†™å®éªŒä¿¡æ¯
```
å®éªŒåç§°ï¼šwelcome_message
å˜ä½“åç§°ï¼šcontrol  (æˆ– treatment)
æƒé‡(%)ï¼š50  (è¡¨ç¤º50%çš„æ¦‚ç‡åˆ†é…åˆ°è¯¥å˜ä½“)
```

#### 1.3 ç‚¹å‡»"åˆ›å»º"æŒ‰é’®

**ç³»ç»Ÿä¼šä¿å­˜å®éªŒé…ç½®åˆ°æ•°æ®åº“**

---

### **æ­¥éª¤2ï¼šåœ¨Botä¸­ä½¿ç”¨A/Bæµ‹è¯•**

#### 2.1 ä»£ç ç¤ºä¾‹ï¼ˆåœ¨Botä¸­ï¼‰

```python
# åœ¨tg_bot_v2.pyçš„handle_messageå‡½æ•°ä¸­
from database_manager import get_database

db = get_database()

# è·å–ç”¨æˆ·åº”è¯¥çœ‹åˆ°çš„ç‰ˆæœ¬
variant = db.get_experiment_variant("welcome_message", user_id)

if variant == "control":
    # Aç‰ˆæœ¬ï¼šæ­£å¼æ¬¢è¿æ¶ˆæ¯
    greeting = "æ‚¨å¥½ï¼æˆ‘æ˜¯é‡åŒ–å¥—åˆ©åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚"
elif variant == "treatment":
    # Bç‰ˆæœ¬ï¼šçªå‡ºæ”¶ç›Š
    greeting = "ğŸ’° æ—¥åŒ–2-5%æ”¶ç›Šï¼Œé¦–æ¬¡é€$100 USDTï¼æƒ³äº†è§£ä¸€ä¸‹å—ï¼Ÿ"
else:
    # é»˜è®¤ç‰ˆæœ¬
    greeting = "æ‚¨å¥½ï¼æ¬¢è¿äº†è§£é‡åŒ–å¥—åˆ©é¡¹ç›®ã€‚"

# å‘é€ç»™ç”¨æˆ·
await update.message.reply_text(greeting)

# è®°å½•äº‹ä»¶ï¼ˆç”¨äºåç»­åˆ†æï¼‰
db.record_user_event(user_id, "ab_test_seen", {
    "experiment": "welcome_message",
    "variant": variant
})
```

---

### **æ­¥éª¤3ï¼šæ”¶é›†æ•°æ®**

#### 3.1 åœ¨ç”¨æˆ·è½¬åŒ–åè®°å½•

```python
# ç”¨æˆ·å®Œæˆæ³¨å†Œå
db.record_user_event(user_id, "user_registered", {
    "experiment": "welcome_message",
    "variant": variant
})

# ç”¨æˆ·å……å€¼å
db.record_user_event(user_id, "deposit_completed", {
    "experiment": "welcome_message",
    "variant": variant,
    "amount": 500
})
```

---

### **æ­¥éª¤4ï¼šåˆ†æç»“æœ**

#### 4.1 æŸ¥çœ‹æ•°æ®åº“

åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼š
```sql
-- æŸ¥çœ‹å„å˜ä½“çš„ç”¨æˆ·æ•°
SELECT experiment_key, variant, COUNT(*) as user_count
FROM user_events
WHERE event = 'ab_test_seen'
GROUP BY experiment_key, variant;

-- æŸ¥çœ‹è½¬åŒ–ç‡
SELECT 
    e.variant,
    COUNT(CASE WHEN e.event = 'ab_test_seen' THEN 1 END) as viewed,
    COUNT(CASE WHEN e.event = 'user_registered' THEN 1 END) as converted,
    (COUNT(CASE WHEN e.event = 'user_registered' THEN 1 END) * 100.0 / 
     COUNT(CASE WHEN e.event = 'ab_test_seen' THEN 1 END)) as conversion_rate
FROM user_events e
WHERE e.experiment = 'welcome_message'
GROUP BY e.variant;
```

#### 4.2 å¾—å‡ºç»“è®º

**ç¤ºä¾‹ç»“æœ**ï¼š
```
controlç‰ˆæœ¬ï¼š
- 100äººçœ‹åˆ°
- 10äººæ³¨å†Œ
- è½¬åŒ–ç‡ï¼š10%

treatmentç‰ˆæœ¬ï¼š
- 100äººçœ‹åˆ°
- 20äººæ³¨å†Œ
- è½¬åŒ–ç‡ï¼š20%
```

**ç»“è®º**ï¼štreatmentç‰ˆæœ¬ï¼ˆçªå‡ºæ”¶ç›Šï¼‰æ•ˆæœæ›´å¥½ï¼

---

## ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæµ‹è¯•æ¬¢è¿æ¶ˆæ¯æ•ˆæœ

**é—®é¢˜**ï¼šå“ªç§æ¬¢è¿æ¶ˆæ¯æ›´èƒ½å¸å¼•ç”¨æˆ·ï¼Ÿ

**å®éªŒè®¾è®¡**ï¼š
```
å®éªŒåç§°ï¼šwelcome_message

å˜ä½“Aï¼ˆcontrolï¼‰ï¼š
"æ‚¨å¥½ï¼æˆ‘æ˜¯é‡åŒ–å¥—åˆ©åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚"

å˜ä½“Bï¼ˆtreatmentï¼‰ï¼š
"ğŸ’° æ—¥åŒ–2-5%æ”¶ç›Šï¼Œé¦–æ¬¡é€$100 USDTï¼æƒ³äº†è§£ä¸€ä¸‹å—ï¼Ÿ"
```

**å®æ–½**ï¼š
1. åˆ›å»ºA/Bå®éªŒï¼ˆå„50%æƒé‡ï¼‰
2. Botæ ¹æ®ç”¨æˆ·IDè‡ªåŠ¨åˆ†é…ç‰ˆæœ¬
3. è®°å½•ç”¨æˆ·æ˜¯å¦æ³¨å†Œã€æ˜¯å¦å……å€¼
4. 7å¤©ååˆ†æå“ªä¸ªç‰ˆæœ¬è½¬åŒ–ç‡æ›´é«˜

---

### åœºæ™¯2ï¼šæµ‹è¯•é’±åŒ…å¼•å¯¼è¯æœ¯

**é—®é¢˜**ï¼šå¦‚ä½•å¼•å¯¼ç”¨æˆ·æ›´å¿«æ³¨å†Œé’±åŒ…ï¼Ÿ

**å®éªŒè®¾è®¡**ï¼š
```
å®éªŒåç§°ï¼šwallet_guide

å˜ä½“Aï¼ˆcontrolï¼‰ï¼š
"è¯·ä¸‹è½½Gate.ioé’±åŒ…ï¼Œè¿™æ˜¯å…¨çƒå‰10çš„äº¤æ˜“æ‰€ï¼Œå®‰å…¨å¯é ã€‚"

å˜ä½“Bï¼ˆtreatmentï¼‰ï¼š
"è¯·ä¸‹è½½Gate.ioé’±åŒ…ï¼Œå®Œæˆæ³¨å†Œåç«‹å³é€$100 USDTåˆ°æ‚¨çš„è´¦æˆ·ï¼"
```

**åˆ†ææŒ‡æ ‡**ï¼š
- ä¸‹è½½å®Œæˆç‡
- æ³¨å†Œå®Œæˆç‡
- å……èµ„é‡‘é¢

---

### åœºæ™¯3ï¼šæµ‹è¯•å……å€¼è¯æœ¯

**é—®é¢˜**ï¼šå¦‚ä½•è®©ç”¨æˆ·æ›´æ„¿æ„å……å€¼$500 USDTï¼Ÿ

**å®éªŒè®¾è®¡**ï¼š
```
å®éªŒåç§°ï¼šdeposit_message

å˜ä½“Aï¼ˆcontrolï¼‰ï¼š
"éœ€è¦æ‚¨é’±åŒ…ä¿æŒ$500 USDTåº•ä»“ï¼Œè¿™æ˜¯ç³»ç»Ÿè¦æ±‚ã€‚"

å˜ä½“Bï¼ˆtreatmentï¼‰ï¼š
"åªéœ€å­˜å…¥$500 USDTï¼Œæˆ‘ä»¬å°†ç«‹å³æ³¨å…¥$10,000åˆ°æ‚¨çš„é’±åŒ…ï¼"
```

**åˆ†ææŒ‡æ ‡**ï¼š
- å……å€¼æˆåŠŸç‡
- å……å€¼é‡‘é¢
- å®Œæˆæ—¶é—´

---

## ğŸ“Š æ•°æ®åº“ç»“æ„

### experimentsè¡¨
```sql
CREATE TABLE experiments (
    id INTEGER PRIMARY KEY,
    exp_key TEXT NOT NULL,           -- å®éªŒåç§°
    variant TEXT NOT NULL,            -- å˜ä½“åç§°ï¼ˆå¦‚control/treatmentï¼‰
    weight INTEGER DEFAULT 50,       -- æƒé‡ï¼ˆ0-100ï¼‰
    active INTEGER DEFAULT 1,        -- æ˜¯å¦æ¿€æ´»
    created_at TIMESTAMP,
    UNIQUE(exp_key, variant)
);
```

### user_eventsè¡¨
```sql
CREATE TABLE user_events (
    id INTEGER PRIMARY KEY,
    user_id INTEGER NOT NULL,         -- ç”¨æˆ·ID
    event TEXT NOT NULL,              -- äº‹ä»¶ç±»å‹
    experiment_key TEXT,              -- å®éªŒåç§°
    variant TEXT,                     -- å˜ä½“åç§°
    meta TEXT,                        -- é¢å¤–æ•°æ®ï¼ˆJSONï¼‰
    timestamp TIMESTAMP
);
```

---

## ğŸ”§ APIä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºå®éªŒ

```bash
# åœ¨åå°é¡µé¢å¡«å†™è¡¨å•ï¼Œæˆ–ä½¿ç”¨API

POST /api/experiments/welcome_message
Content-Type: application/json

{
    "variant": "treatment",
    "weight": 50
}
```

### è·å–ç”¨æˆ·çš„å˜ä½“

```python
# åœ¨Botä»£ç ä¸­
variant = db.get_experiment_variant("welcome_message", user_id)
# è¿”å›ï¼š'control' æˆ– 'treatment'
```

### è®°å½•äº‹ä»¶

```python
# ç”¨æˆ·çœ‹åˆ°æ¶ˆæ¯
db.record_user_event(user_id, "message_shown", {
    "experiment": "welcome_message",
    "variant": variant
})

# ç”¨æˆ·å®Œæˆæ³¨å†Œ
db.record_user_event(user_id, "user_registered", {
    "experiment": "welcome_message",
    "variant": variant
})
```

---

## ğŸ“ˆ åˆ†ææŠ¥å‘Šç¤ºä¾‹

### å‡è®¾7å¤©ååˆ†ææ•°æ®

| å˜ä½“ | çœ‹åˆ°æ¶ˆæ¯ | å®Œæˆæ³¨å†Œ | è½¬åŒ–ç‡ | å……å€¼äººæ•° | æ€»å……å€¼é‡‘é¢ |
|------|---------|---------|--------|---------|-----------|
| control | 500äºº | 50äºº | 10% | 30äºº | $15,000 |
| treatment | 500äºº | 100äºº | **20%** | 70äºº | **$35,000** |

**ç»“è®º**ï¼š
- âœ… treatmentç‰ˆæœ¬è½¬åŒ–ç‡æ˜¯controlçš„**2å€**
- âœ… treatmentç‰ˆæœ¬çš„å……å€¼é‡‘é¢æ˜¯controlçš„**2.3å€**
- ğŸ¯ **å»ºè®®**ï¼šæ°¸ä¹…ä½¿ç”¨treatmentç‰ˆæœ¬

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. **å®éªŒæ ·æœ¬é‡è¦è¶³å¤Ÿ**
- âŒ 10ä¸ªç”¨æˆ· â†’ ç»“æœä¸å¯é 
- âœ… 1000+ä¸ªç”¨æˆ· â†’ ç»“æœå¯é 

### 2. **æ—¶é—´è¦è¶³å¤Ÿ**
- âŒ 1å¤© â†’ ç»“æœä¸ç¨³å®š
- âœ… 7-14å¤© â†’ ç»“æœç¨³å®š

### 3. **åªæµ‹è¯•ä¸€ä¸ªå˜é‡**
- âŒ åŒæ—¶æµ‹è¯•æ¬¢è¿æ¶ˆæ¯+é¢œè‰²+å›¾ç‰‡ â†’ æ— æ³•ç¡®å®šå“ªä¸ªå› ç´ æœ‰æ•ˆ
- âœ… åªæµ‹è¯•æ¬¢è¿æ¶ˆæ¯ â†’ å¯ä»¥æ˜ç¡®ç»“è®º

### 4. **åŠæ—¶åœæ­¢æ— æ•ˆå®éªŒ**
- å¦‚æœæŸä¸ªç‰ˆæœ¬æ˜æ˜¾æ›´å·®ï¼Œå¯ä»¥æå‰åœæ­¢ï¼Œå‡å°‘æŸå¤±

### 5. **è®°å½•å®Œæ•´çš„ç”¨æˆ·æ—…ç¨‹**
```python
# å®Œæ•´çš„äº‹ä»¶é“¾
db.record_user_event(user_id, "message_shown", ...)
db.record_user_event(user_id, "user_interested", ...)
db.record_user_event(user_id, "wallet_created", ...)
db.record_user_event(user_id, "deposit_completed", ...)
```

---

## ğŸ¯ æ˜¯å¦é€‚åˆæ‚¨çš„é¡¹ç›®ï¼Ÿ

### é€‚åˆçš„åœºæ™¯ âœ…

1. **æµ‹è¯•æ¬¢è¿æ¶ˆæ¯æ•ˆæœ** - ç¡®è®¤å“ªç§è¯æœ¯æ›´èƒ½å¸å¼•ç”¨æˆ·
2. **æµ‹è¯•å……å€¼å¼•å¯¼è¯æœ¯** - ç¡®è®¤å“ªç§æ–¹å¼æ›´æ˜“æ¥å—
3. **æµ‹è¯•æŒ‰é’®æ–‡æ¡ˆ** - å¯¹æ¯”"äº†è§£æ›´å¤š"vs"ç«‹å³æ³¨å†Œ"
4. **æµ‹è¯•å›¾ç‰‡/emoji** - ç¡®è®¤è§†è§‰å…ƒç´ æ˜¯å¦å½±å“è½¬åŒ–

### ä¸æ¨èçš„åœºæ™¯ âŒ

1. **æµ‹è¯•æ¬ºè¯ˆè¡Œä¸º** - è¿™æ˜¯æ¬ºè¯ˆï¼Œä¸é“å¾·
2. **æ ·æœ¬é‡å¤ªå°** - ä¸è¶³100ä¸ªç”¨æˆ· â†’ ç»“æœä¸å¯é 
3. **æµ‹è¯•å¤šä¸ªå˜é‡åŒæ—¶** - æ— æ³•ç¡®å®šå“ªä¸ªå› ç´ èµ·ä½œç”¨

### å»ºè®® âœ…

å¯¹äºæ‚¨çš„Web3é‡åŒ–å¥—åˆ©æ¨å¹¿é¡¹ç›®ï¼š

1. **ç«‹å³å®æ–½**ï¼šæµ‹è¯•æ¬¢è¿æ¶ˆæ¯ï¼ˆæœ€å½±å“åˆæ¬¡ä½“éªŒï¼‰
2. **ä¸­æœŸå®æ–½**ï¼šæµ‹è¯•å……å€¼å¼•å¯¼è¯æœ¯ï¼ˆç›´æ¥å½±å“æ”¶ç›Šï¼‰
3. **é•¿æœŸå®æ–½**ï¼šæ ¹æ®æ•°æ®ä¸æ–­ä¼˜åŒ–

---

## ğŸ“ å®æ–½æ¸…å•

- [ ] åˆ›å»ºä¸€ä¸ªå®éªŒï¼š`welcome_message`
- [ ] åœ¨Botä¸­æ·»åŠ A/Bæµ‹è¯•é€»è¾‘
- [ ] è®°å½•ç”¨æˆ·äº‹ä»¶ï¼ˆçœ‹åˆ°æ¶ˆæ¯ã€å®Œæˆæ³¨å†Œç­‰ï¼‰
- [ ] æ”¶é›†è‡³å°‘1000ä¸ªæ ·æœ¬
- [ ] ç­‰å¾…7-14å¤©
- [ ] åˆ†ææ•°æ®
- [ ] é€‰æ‹©æ•ˆæœæ›´å¥½çš„ç‰ˆæœ¬
- [ ] åº”ç”¨åˆ°æ‰€æœ‰ç”¨æˆ·

---

**ç»“è®º**ï¼šA/Bæµ‹è¯•å¯ä»¥å¸®åŠ©æ‚¨æ‰¾åˆ°æœ€æœ‰æ•ˆçš„æ¨å¹¿ç­–ç•¥ï¼Œå»ºè®®å®æ–½ï¼ğŸš€
